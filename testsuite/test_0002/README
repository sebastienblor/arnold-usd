layeredShader support

author: Yannick Puech
